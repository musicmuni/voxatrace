"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[6416],{2306(e,r,n){n.r(r),n.d(r,{assets:()=>a,contentTitle:()=>s,default:()=>x,frontMatter:()=>t,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"sonix/mixer","title":"SonixMixer","description":"Multi-track audio mixer that plays multiple audio files synchronized with independent per-track volume control.","source":"@site/docs/sonix/mixer.md","sourceDirName":"sonix","slug":"/sonix/mixer","permalink":"/sonix/mixer","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"docsSidebar","previous":{"title":"SonixRecorder","permalink":"/sonix/recorder"},"next":{"title":"SonixMetronome","permalink":"/sonix/metronome"}}');var l=n(4848),o=n(8453);const t={sidebar_position:4},s="SonixMixer",a={},d=[{value:"Quick Start",id:"quick-start",level:2},{value:"Kotlin",id:"kotlin",level:3},{value:"Swift",id:"swift",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Presets",id:"presets",level:3},{value:"Builder",id:"builder",level:3},{value:"Kotlin",id:"kotlin-1",level:4},{value:"Swift",id:"swift-1",level:4},{value:"Config Properties",id:"config-properties",level:3},{value:"Callbacks",id:"callbacks",level:3},{value:"Track Management",id:"track-management",level:2},{value:"Add Tracks",id:"add-tracks",level:3},{value:"From File (auto-decodes)",id:"from-file-auto-decodes",level:4},{value:"From Raw PCM Data",id:"from-raw-pcm-data",level:4},{value:"Query and Remove Tracks",id:"query-and-remove-tracks",level:3},{value:"Playback Controls",id:"playback-controls",level:2},{value:"Per-Track Volume",id:"per-track-volume",level:2},{value:"Looping",id:"looping",level:2},{value:"Observing State",id:"observing-state",level:2},{value:"Kotlin (StateFlow)",id:"kotlin-stateflow",level:3},{value:"Swift (Observers)",id:"swift-observers",level:3},{value:"Swift (Combine)",id:"swift-combine",level:3},{value:"StateFlows",id:"stateflows",level:3},{value:"Properties",id:"properties",level:3},{value:"Listener Interface",id:"listener-interface",level:2},{value:"Common Patterns",id:"common-patterns",level:2},{value:"Karaoke Mixer ViewModel",id:"karaoke-mixer-viewmodel",level:3},{value:"Next Steps",id:"next-steps",level:2}];function c(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.header,{children:(0,l.jsx)(r.h1,{id:"sonixmixer",children:"SonixMixer"})}),"\n",(0,l.jsx)(r.p,{children:"Multi-track audio mixer that plays multiple audio files synchronized with independent per-track volume control."}),"\n",(0,l.jsx)(r.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,l.jsx)(r.h3,{id:"kotlin",children:"Kotlin"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-kotlin",children:'val mixer = SonixMixer.create()\r\nmixer.addTrack("backing", "/path/to/backing.mp3")\r\nmixer.addTrack("vocal", "/path/to/vocal.mp3")\r\nmixer.play()\r\n\r\n// Control individual tracks\r\nmixer.setTrackVolume("vocal", 0.5f)\r\n\r\n// Release when done\r\nmixer.release()\n'})}),"\n",(0,l.jsx)(r.h3,{id:"swift",children:"Swift"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-swift",children:'let mixer = SonixMixer.create()\r\nawait mixer.addTrack(name: "backing", filePath: "/path/to/backing.mp3")\r\nawait mixer.addTrack(name: "vocal", filePath: "/path/to/vocal.mp3")\r\nmixer.play()\r\n\r\n// Control individual tracks\r\nmixer.setTrackVolume(name: "vocal", volume: 0.5)\r\n\r\n// Release when done\r\nmixer.release()\n'})}),"\n",(0,l.jsx)(r.h2,{id:"configuration",children:"Configuration"}),"\n",(0,l.jsx)(r.h3,{id:"presets",children:"Presets"}),"\n",(0,l.jsxs)(r.table,{children:[(0,l.jsx)(r.thead,{children:(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.th,{children:"Preset"}),(0,l.jsx)(r.th,{children:"Kotlin"}),(0,l.jsx)(r.th,{children:"Swift"}),(0,l.jsx)(r.th,{children:"Description"})]})}),(0,l.jsxs)(r.tbody,{children:[(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:"Default"}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"SonixMixerConfig.DEFAULT"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:".default"})}),(0,l.jsx)(r.td,{children:"Play once"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:"Looping"}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"SonixMixerConfig.LOOPING"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:".looping"})}),(0,l.jsx)(r.td,{children:"Infinite loop"})]})]})]}),"\n",(0,l.jsx)(r.h3,{id:"builder",children:"Builder"}),"\n",(0,l.jsx)(r.h4,{id:"kotlin-1",children:"Kotlin"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-kotlin",children:'val config = SonixMixerConfig.Builder()\r\n    .loopCount(3)\r\n    .onPlaybackComplete { println("All loops done!") }\r\n    .onLoopComplete { index -> println("Completed loop $index") }\r\n    .onError { error -> showError(error) }\r\n    .build()\r\n\r\nval mixer = SonixMixer.create(config)\n'})}),"\n",(0,l.jsx)(r.h4,{id:"swift-1",children:"Swift"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-swift",children:'let config = SonixMixerConfig.Builder()\r\n    .loopCount(3)\r\n    .onPlaybackComplete { print("All loops done!") }\r\n    .onLoopComplete { index in print("Completed loop \\(index)") }\r\n    .onError { error in print("Error: \\(error)") }\r\n    .build()\r\n\r\nlet mixer = SonixMixer.create(config: config)\n'})}),"\n",(0,l.jsx)(r.h3,{id:"config-properties",children:"Config Properties"}),"\n",(0,l.jsxs)(r.table,{children:[(0,l.jsx)(r.thead,{children:(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.th,{children:"Property"}),(0,l.jsx)(r.th,{children:"Type"}),(0,l.jsx)(r.th,{children:"Default"}),(0,l.jsx)(r.th,{children:"Description"})]})}),(0,l.jsx)(r.tbody,{children:(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"loopCount"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"Int"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"1"})}),(0,l.jsx)(r.td,{children:"Times to play (1 = once, -1 = infinite)"})]})})]}),"\n",(0,l.jsx)(r.h3,{id:"callbacks",children:"Callbacks"}),"\n",(0,l.jsxs)(r.table,{children:[(0,l.jsx)(r.thead,{children:(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.th,{children:"Builder Method"}),(0,l.jsx)(r.th,{children:"Signature"}),(0,l.jsx)(r.th,{children:"Description"})]})}),(0,l.jsxs)(r.tbody,{children:[(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"onPlaybackComplete"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"() -> Unit"})}),(0,l.jsx)(r.td,{children:"All loops completed"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"onLoopComplete"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"(loopIndex: Int) -> Unit"})}),(0,l.jsx)(r.td,{children:"Single loop iteration completed"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"onError"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"(error: String) -> Unit"})}),(0,l.jsx)(r.td,{children:"Playback error occurred"})]})]})]}),"\n",(0,l.jsx)(r.h2,{id:"track-management",children:"Track Management"}),"\n",(0,l.jsx)(r.h3,{id:"add-tracks",children:"Add Tracks"}),"\n",(0,l.jsx)(r.h4,{id:"from-file-auto-decodes",children:"From File (auto-decodes)"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-kotlin",children:'// Suspending \u2014 auto-decodes MP3, M4A, WAV, etc.\r\nval success = mixer.addTrack("backing", "/path/to/backing.mp3")\n'})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-swift",children:'let success = await mixer.addTrack(name: "backing", filePath: "/path/to/backing.mp3")\n'})}),"\n",(0,l.jsx)(r.h4,{id:"from-raw-pcm-data",children:"From Raw PCM Data"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-kotlin",children:'val pcmData: ByteArray = ...\r\nmixer.addTrack("synth", pcmData, sampleRate = 44100, channels = 1)\n'})}),"\n",(0,l.jsx)(r.h3,{id:"query-and-remove-tracks",children:"Query and Remove Tracks"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-kotlin",children:'val names: List<String> = mixer.getTrackNames()\r\nval exists: Boolean = mixer.hasTrack("backing")\r\nmixer.removeTrack("vocal")\n'})}),"\n",(0,l.jsx)(r.h2,{id:"playback-controls",children:"Playback Controls"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-kotlin",children:"mixer.play()                   // Start all tracks synchronized\r\nmixer.pause()                  // Pause all tracks\r\nmixer.stop()                   // Stop and reset to beginning\r\nmixer.reset()                  // Reset position without stopping\r\nmixer.seek(positionMs = 30000) // Seek all tracks to 30 seconds\n"})}),"\n",(0,l.jsx)(r.h2,{id:"per-track-volume",children:"Per-Track Volume"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-kotlin",children:'// Set immediately\r\nmixer.setTrackVolume("vocal", 0.3f)\r\n\r\n// Fade from current volume to target\r\nmixer.fadeTrackVolume("vocal", targetVolume = 0f, durationMs = 2000)\r\n\r\n// Fade between specific volumes\r\nmixer.fadeTrackVolume("vocal", startVolume = 1f, endVolume = 0f, durationMs = 2000)\n'})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-swift",children:'mixer.setTrackVolume(name: "vocal", volume: 0.3)\r\nmixer.fadeTrackVolume(name: "vocal", targetVolume: 0, durationMs: 2000)\r\nmixer.fadeTrackVolume(name: "vocal", startVolume: 1, endVolume: 0, durationMs: 2000)\n'})}),"\n",(0,l.jsx)(r.h2,{id:"looping",children:"Looping"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-kotlin",children:"// Set at creation\r\nval mixer = SonixMixer.create(SonixMixerConfig.LOOPING)\r\n\r\n// Via builder\r\nval config = SonixMixerConfig.Builder()\r\n    .loopForever()\r\n    .build()\r\n\r\n// Change at runtime\r\nmixer.loopCount = 3    // Play 3 times\r\nmixer.loopCount = -1   // Infinite\r\n\r\n// Check progress\r\nval completed = mixer.completedLoops\n"})}),"\n",(0,l.jsx)(r.h2,{id:"observing-state",children:"Observing State"}),"\n",(0,l.jsx)(r.h3,{id:"kotlin-stateflow",children:"Kotlin (StateFlow)"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-kotlin",children:"mixer.isPlaying.collect { playing ->\r\n    playButton.icon = if (playing) pauseIcon else playIcon\r\n}\r\n\r\nmixer.currentTime.collect { timeMs ->\r\n    seekBar.progress = timeMs.toInt()\r\n}\r\n\r\nmixer.error.collect { error ->\r\n    error?.let { showError(it.message) }\r\n}\r\n\r\n// Duration (not a flow)\r\nval totalMs = mixer.duration\n"})}),"\n",(0,l.jsx)(r.h3,{id:"swift-observers",children:"Swift (Observers)"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-swift",children:"let playingTask = mixer.observeIsPlaying { isPlaying in\r\n    self.isPlaying = isPlaying\r\n}\r\n\r\nlet timeTask = mixer.observeCurrentTime { timeMs in\r\n    self.currentTimeMs = timeMs\r\n}\r\n\r\nlet errorTask = mixer.observeError { error in\r\n    if let error = error { self.showError(error.message) }\r\n}\n"})}),"\n",(0,l.jsx)(r.h3,{id:"swift-combine",children:"Swift (Combine)"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-swift",children:"mixer.isPlayingPublisher\r\n    .receive(on: DispatchQueue.main)\r\n    .sink { self.isPlaying = $0 }\r\n    .store(in: &cancellables)\n"})}),"\n",(0,l.jsx)(r.h3,{id:"stateflows",children:"StateFlows"}),"\n",(0,l.jsxs)(r.table,{children:[(0,l.jsx)(r.thead,{children:(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.th,{children:"StateFlow"}),(0,l.jsx)(r.th,{children:"Type"}),(0,l.jsx)(r.th,{children:"Description"})]})}),(0,l.jsxs)(r.tbody,{children:[(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"currentTime"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"StateFlow<Long>"})}),(0,l.jsx)(r.td,{children:"Playback position in milliseconds"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"isPlaying"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"StateFlow<Boolean>"})}),(0,l.jsx)(r.td,{children:"Whether currently playing"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"error"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"StateFlow<SonixError?>"})}),(0,l.jsx)(r.td,{children:"Error state"})]})]})]}),"\n",(0,l.jsx)(r.h3,{id:"properties",children:"Properties"}),"\n",(0,l.jsxs)(r.table,{children:[(0,l.jsx)(r.thead,{children:(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.th,{children:"Property"}),(0,l.jsx)(r.th,{children:"Type"}),(0,l.jsx)(r.th,{children:"Description"})]})}),(0,l.jsxs)(r.tbody,{children:[(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"duration"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"Long"})}),(0,l.jsx)(r.td,{children:"Total duration in ms (longest track)"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"completedLoops"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"Int"})}),(0,l.jsx)(r.td,{children:"Number of completed loop iterations"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"loopCount"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"Int"})}),(0,l.jsx)(r.td,{children:"Current loop count setting (mutable)"})]})]})]}),"\n",(0,l.jsx)(r.h2,{id:"listener-interface",children:"Listener Interface"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-kotlin",children:'mixer.setPlaybackListener(object : SonixMixer.PlaybackListener {\r\n    override fun onPlaybackStarted(startTimeMs: Long) { println("Started at $startTimeMs") }\r\n    override fun onPlaybackPaused(playbackTimeMs: Long) { println("Paused at $playbackTimeMs") }\r\n    override fun onPlaybackCompleted() { println("All done!") }\r\n    override fun onLoopCompleted(loopIndex: Int) { println("Loop $loopIndex done") }\r\n    override fun onError(error: String) { showError(error) }\r\n})\n'})}),"\n",(0,l.jsx)(r.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,l.jsx)(r.h3,{id:"karaoke-mixer-viewmodel",children:"Karaoke Mixer ViewModel"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-kotlin",children:'class MultiTrackViewModel : ViewModel() {\r\n    private var mixer: SonixMixer? = null\r\n\r\n    fun loadTracks(backingPath: String, vocalPath: String) {\r\n        val config = SonixMixerConfig.Builder()\r\n            .onPlaybackComplete { /* show results */ }\r\n            .build()\r\n\r\n        mixer = SonixMixer.create(config)\r\n\r\n        viewModelScope.launch {\r\n            mixer!!.addTrack("backing", backingPath)\r\n            mixer!!.addTrack("vocal", vocalPath)\r\n            mixer!!.setTrackVolume("vocal", 0.3f)\r\n        }\r\n    }\r\n\r\n    fun playPause() {\r\n        val m = mixer ?: return\r\n        if (m.isPlaying.value) m.pause() else m.play()\r\n    }\r\n\r\n    fun toggleVocal(enabled: Boolean) {\r\n        mixer?.fadeTrackVolume("vocal",\r\n            targetVolume = if (enabled) 0.3f else 0f,\r\n            durationMs = 500\r\n        )\r\n    }\r\n\r\n    override fun onCleared() {\r\n        mixer?.release()\r\n    }\r\n}\n'})}),"\n",(0,l.jsx)(r.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsxs)(r.li,{children:[(0,l.jsx)(r.a,{href:"./player",children:"SonixPlayer"})," \u2014 Single-file playback"]}),"\n",(0,l.jsxs)(r.li,{children:[(0,l.jsx)(r.a,{href:"./metronome",children:"SonixMetronome"})," \u2014 Click track for practice"]}),"\n",(0,l.jsxs)(r.li,{children:[(0,l.jsx)(r.a,{href:"./recorder",children:"SonixRecorder"})," \u2014 Record audio alongside mixer playback"]}),"\n"]})]})}function x(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,l.jsx)(r,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},8453(e,r,n){n.d(r,{R:()=>t,x:()=>s});var i=n(6540);const l={},o=i.createContext(l);function t(e){const r=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function s(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),i.createElement(o.Provider,{value:r},e.children)}}}]);