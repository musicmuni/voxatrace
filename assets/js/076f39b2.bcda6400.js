"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[2640],{7258(e,n,d){d.r(n),d.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"calibra/vocal-range","title":"CalibraVocalRange","description":"Streaming vocal range analyzer and guided session for determining a singer\'s pitch range. Includes both a low-level analyzer (CalibraVocalRange) and a high-level session (VocalRangeSession) with observable state.","source":"@site/docs/calibra/vocal-range.md","sourceDirName":"calibra","slug":"/calibra/vocal-range","permalink":"/voxatrace/calibra/vocal-range","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"docsSidebar","previous":{"title":"CalibraVAD","permalink":"/voxatrace/calibra/vad"},"next":{"title":"CalibraLiveEval","permalink":"/voxatrace/calibra/live-eval"}}');var s=d(4848),r=d(8453);const i={sidebar_position:4},l="CalibraVocalRange",c={},a=[{value:"Quick Start",id:"quick-start",level:2},{value:"Kotlin",id:"kotlin",level:3},{value:"Swift",id:"swift",level:3},{value:"CalibraVocalRange (Low-Level Analyzer)",id:"calibravocalrange-low-level-analyzer",level:2},{value:"Creating an Analyzer",id:"creating-an-analyzer",level:3},{value:"Swift Config Convenience Methods",id:"swift-config-convenience-methods",level:3},{value:"Configuration",id:"configuration",level:3},{value:"Methods",id:"methods",level:3},{value:"Result Types",id:"result-types",level:3},{value:"VocalRange",id:"vocalrange",level:4},{value:"VocalPitch",id:"vocalpitch",level:4},{value:"DetectedNote",id:"detectednote",level:4},{value:"RangeStats",id:"rangestats",level:4},{value:"Guided Range Detection",id:"guided-range-detection",level:3},{value:"Static Utility Methods",id:"static-utility-methods",level:3},{value:"VocalRangeSession (High-Level)",id:"vocalrangesession-high-level",level:2},{value:"Creating a Session",id:"creating-a-session",level:3},{value:"Session Configuration",id:"session-configuration",level:3},{value:"Presets",id:"presets",level:3},{value:"Auto-Flow Mode (Recommended)",id:"auto-flow-mode-recommended",level:3},{value:"Observing State",id:"observing-state",level:3},{value:"Kotlin (StateFlow)",id:"kotlin-stateflow",level:4},{value:"VocalRangeState",id:"vocalrangestate",level:3},{value:"VocalRangePhase",id:"vocalrangephase",level:3},{value:"VocalRangeResult",id:"vocalrangeresult",level:3},{value:"Session Methods",id:"session-methods",level:3},{value:"Manual Flow Control",id:"manual-flow-control",level:3},{value:"Next Steps",id:"next-steps",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"calibravocalrange",children:"CalibraVocalRange"})}),"\n",(0,s.jsxs)(n.p,{children:["Streaming vocal range analyzer and guided session for determining a singer's pitch range. Includes both a low-level analyzer (",(0,s.jsx)(n.code,{children:"CalibraVocalRange"}),") and a high-level session (",(0,s.jsx)(n.code,{children:"VocalRangeSession"}),") with observable state."]}),"\n",(0,s.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,s.jsx)(n.h3,{id:"kotlin",children:"Kotlin"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'val analyzer = CalibraVocalRange.create()\r\n\r\n// Feed audio from recorder\r\nrecorder.audioBuffers.collect { buffer ->\r\n    analyzer.addAudio(buffer.toFloatArray())\r\n}\r\n\r\n// Get detected range\r\nval range = analyzer.getRange()\r\nif (range != null) {\r\n    println("Range: ${range.lower.noteLabel} to ${range.upper.noteLabel}")\r\n    println("Octaves: ${range.octaves}")\r\n}\r\n\r\nanalyzer.release()\n'})}),"\n",(0,s.jsx)(n.h3,{id:"swift",children:"Swift"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'let analyzer = CalibraVocalRange.create()\r\n\r\n// Feed audio from recorder\r\nfor await buffer in recorder.audioBuffersStream() {\r\n    analyzer.addAudio(samples: buffer.toFloatArray())\r\n}\r\n\r\n// Get detected range\r\nif let range = analyzer.getRange() {\r\n    print("Range: \\(range.lower.noteLabel) to \\(range.upper.noteLabel)")\r\n    print("Octaves: \\(range.octaves)")\r\n}\r\n\r\nanalyzer.release()\n'})}),"\n",(0,s.jsx)(n.h2,{id:"calibravocalrange-low-level-analyzer",children:"CalibraVocalRange (Low-Level Analyzer)"}),"\n",(0,s.jsx)(n.h3,{id:"creating-an-analyzer",children:"Creating an Analyzer"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:"// Default config (ASHA 2018 guidelines)\r\nval analyzer = CalibraVocalRange.create()\r\n\r\n// Custom config\r\nval analyzer = CalibraVocalRange.create(VocalRangeConfig(\r\n    minNoteDurationSeconds = 0.5f,\r\n    minConfidence = 0.7f\r\n))\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:"let analyzer = CalibraVocalRange.create()\r\n\r\nlet analyzer = CalibraVocalRange.create(config: VocalRangeConfig(\r\n    minNoteDurationSeconds: 0.5,\r\n    minConfidence: 0.7,\r\n    stabilityWindowMs: 50,\r\n    maxDeviationSemitones: 1.0,\r\n    sampleRate: 16000\r\n))\n"})}),"\n",(0,s.jsx)(n.h3,{id:"swift-config-convenience-methods",children:"Swift Config Convenience Methods"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:"let config = VocalRangeConfig.fastDetection()     // 0.5s hold time\r\nlet config = VocalRangeConfig.strictDetection()    // 1.5s hold, 0.7 confidence\r\nlet config = VocalRangeConfig.withMinDuration(2.0) // Custom hold time\n"})}),"\n",(0,s.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"minNoteDurationSeconds"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Float"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"1.0"})}),(0,s.jsx)(n.td,{children:"Minimum duration for a note to be included"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"minConfidence"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Float"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"0.5"})}),(0,s.jsx)(n.td,{children:"Minimum pitch detection confidence"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"stabilityWindowMs"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Float"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"50"})}),(0,s.jsx)(n.td,{children:"Window for stability checking (ms)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"maxDeviationSemitones"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Float"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"1.0"})}),(0,s.jsx)(n.td,{children:'Maximum deviation for "stable" pitch'})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"sampleRate"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Int"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"16000"})}),(0,s.jsx)(n.td,{children:"Expected audio sample rate"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"methods",children:"Methods"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Method"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"addAudio(samples)"})}),(0,s.jsx)(n.td,{children:"Feed audio samples for analysis"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"getRange()"})}),(0,s.jsx)(n.td,{children:"Get complete range (lower/upper/octaves), or null if not enough data"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"getStableNote()"})}),(0,s.jsx)(n.td,{children:"Get the longest stable note detected so far"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"getLowerLimit()"})}),(0,s.jsx)(n.td,{children:"Get 5th percentile pitch (lower bound)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"getUpperLimit()"})}),(0,s.jsx)(n.td,{children:"Get 95th percentile pitch (upper bound)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"getStats()"})}),(0,s.jsx)(n.td,{children:"Get detection statistics"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"reset()"})}),(0,s.jsx)(n.td,{children:"Reset for new detection session"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"release()"})}),(0,s.jsx)(n.td,{children:"Release resources"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"result-types",children:"Result Types"}),"\n",(0,s.jsx)(n.h4,{id:"vocalrange",children:"VocalRange"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"lower"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"VocalPitch"})}),(0,s.jsx)(n.td,{children:"5th percentile (physiological low)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"upper"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"VocalPitch"})}),(0,s.jsx)(n.td,{children:"95th percentile (physiological high)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"octaves"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Float"})}),(0,s.jsx)(n.td,{children:"Range in octaves"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"semitones"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Int"})}),(0,s.jsx)(n.td,{children:"Range in semitones"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"vocalpitch",children:"VocalPitch"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"frequencyHz"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Float"})}),(0,s.jsx)(n.td,{children:"Frequency in Hz"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"midiNote"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Int"})}),(0,s.jsx)(n.td,{children:"MIDI note number (0\u2013127)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"noteLabel"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"String"})}),(0,s.jsx)(n.td,{children:'Note name with octave (e.g., "C4", "F#3")'})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"confidence"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Float"})}),(0,s.jsx)(n.td,{children:"Detection confidence (0.0\u20131.0)"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"detectednote",children:"DetectedNote"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"pitch"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"VocalPitch"})}),(0,s.jsx)(n.td,{children:"The detected pitch"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"durationSeconds"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Float"})}),(0,s.jsx)(n.td,{children:"How long this note was held stably"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"isStable"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Boolean"})}),(0,s.jsx)(n.td,{children:"Whether the note met stability criteria"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"rangestats",children:"RangeStats"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"totalPitchesReceived"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Int"})}),(0,s.jsx)(n.td,{children:"Total pitch frames processed"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"validPitchesAfterFiltering"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Int"})}),(0,s.jsx)(n.td,{children:"Frames that passed confidence filter"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"stableSegmentsDetected"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Int"})}),(0,s.jsx)(n.td,{children:"Number of stable segments found"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"longestStableSegmentSeconds"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Float"})}),(0,s.jsx)(n.td,{children:"Duration of longest stable segment"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"hasEnoughDataForRange"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Boolean"})}),(0,s.jsx)(n.td,{children:"Whether enough data for range calculation"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"guided-range-detection",children:"Guided Range Detection"}),"\n",(0,s.jsx)(n.p,{children:'For step-by-step range finding (e.g., "sing your lowest note"):'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'val analyzer = CalibraVocalRange.create()\r\n\r\n// Phase 1: Detect lowest note\r\nshowPrompt("Sing your lowest comfortable note")\r\n// ... feed audio via addAudio() ...\r\nval lowestNote = analyzer.getStableNote()\r\nanalyzer.reset()\r\n\r\n// Phase 2: Detect highest note\r\nshowPrompt("Sing your highest comfortable note")\r\n// ... feed audio via addAudio() ...\r\nval highestNote = analyzer.getStableNote()\r\n\r\nanalyzer.release()\n'})}),"\n",(0,s.jsx)(n.h3,{id:"static-utility-methods",children:"Static Utility Methods"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'val label = CalibraVocalRange.labelForMidi(60)  // "C4"\r\nval midi = CalibraVocalRange.hzToMidi(440f)     // 69\r\nval hz = CalibraVocalRange.midiToHz(69)         // 440.0\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'let label = CalibraVocalRange.labelForMidi(60)  // "C4"\r\nlet midi = CalibraVocalRange.hzToMidi(440)      // 69\r\nlet hz = CalibraVocalRange.midiToHz(69)         // 440.0\n'})}),"\n",(0,s.jsx)(n.h2,{id:"vocalrangesession-high-level",children:"VocalRangeSession (High-Level)"}),"\n",(0,s.jsx)(n.p,{children:"A high-level session with observable state that manages the full detection flow: countdown, detect low note, transition, detect high note, complete."}),"\n",(0,s.jsx)(n.h3,{id:"creating-a-session",children:"Creating a Session"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:"val detector = CalibraPitch.createDetector()\r\nval session = VocalRangeSession.create(detector = detector)\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:"let detector = CalibraPitch.createDetector()\r\nlet session = VocalRangeSession.create(detector: detector)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"session-configuration",children:"Session Configuration"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"countdownSeconds"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Int"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"3"})}),(0,s.jsx)(n.td,{children:"Countdown before detection starts"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"maxDetectionTimeSeconds"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Int"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"10"})}),(0,s.jsx)(n.td,{children:"Max time to wait for stable note"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"minNoteDurationSeconds"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Float"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"1.0"})}),(0,s.jsx)(n.td,{children:"Minimum stable note duration"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"minConfidence"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Float"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"0.5"})}),(0,s.jsx)(n.td,{children:"Minimum pitch confidence"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"transitionDelayMs"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Long"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"500"})}),(0,s.jsx)(n.td,{children:"Delay between low and high detection"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"autoFlow"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Boolean"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"true"})}),(0,s.jsx)(n.td,{children:"Run automatic flow"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"presets",children:"Presets"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Preset"}),(0,s.jsx)(n.th,{children:"Kotlin"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Default"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"VocalRangeSessionConfig.DEFAULT"})}),(0,s.jsx)(n.td,{children:"Auto-flow with 3s countdown"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Manual"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"VocalRangeSessionConfig.MANUAL_FLOW"})}),(0,s.jsx)(n.td,{children:"Manual phase control"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"auto-flow-mode-recommended",children:"Auto-Flow Mode (Recommended)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'val session = VocalRangeSession.create(detector = CalibraPitch.createDetector())\r\n\r\n// Observe state in UI\r\nsession.state.collect { state ->\r\n    when (state.phase) {\r\n        VocalRangePhase.COUNTDOWN -> showCountdown(state.countdownSeconds)\r\n        VocalRangePhase.DETECTING_LOW -> showLowDetection(state)\r\n        VocalRangePhase.DETECTING_HIGH -> showHighDetection(state)\r\n        VocalRangePhase.COMPLETE -> showResult(state.result!!)\r\n        else -> {}\r\n    }\r\n}\r\n\r\n// Start detection\r\nsession.start()\r\n\r\n// Feed audio\r\nrecorder.audioBuffers.collect { buffer ->\r\n    session.addAudio(buffer.samples, sampleRate = buffer.sampleRate)\r\n}\r\n\r\n// User taps "Lock" button\r\nsession.confirmNote()\r\n\r\nsession.release()\n'})}),"\n",(0,s.jsx)(n.h3,{id:"observing-state",children:"Observing State"}),"\n",(0,s.jsx)(n.h4,{id:"kotlin-stateflow",children:"Kotlin (StateFlow)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:"session.state.collect { state ->\r\n    updatePhaseUI(state.phase)\r\n    updatePitchDisplay(state.currentPitch)\r\n    updateStabilityBar(state.stabilityProgress)\r\n    state.bestLowNote?.let { showBestLow(it) }\r\n    state.bestHighNote?.let { showBestHigh(it) }\r\n    state.result?.let { showFinalResult(it) }\r\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"vocalrangestate",children:"VocalRangeState"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"phase"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"VocalRangePhase"})}),(0,s.jsx)(n.td,{children:"Current detection phase"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"countdownSeconds"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Int"})}),(0,s.jsx)(n.td,{children:"Remaining countdown seconds"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"phaseMessage"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"String"})}),(0,s.jsx)(n.td,{children:"User-facing status message"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"currentPitch"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"VocalPitch?"})}),(0,s.jsx)(n.td,{children:"Real-time detected pitch"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"currentAmplitude"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Float"})}),(0,s.jsx)(n.td,{children:"Current audio amplitude"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"stabilityProgress"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Float"})}),(0,s.jsx)(n.td,{children:"Progress toward stable note (0.0\u20131.0)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"bestLowNote"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"DetectedNote?"})}),(0,s.jsx)(n.td,{children:"Lowest stable note found so far"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"bestHighNote"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"DetectedNote?"})}),(0,s.jsx)(n.td,{children:"Highest stable note found so far"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"lowNote"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"DetectedNote?"})}),(0,s.jsx)(n.td,{children:"Locked low note (confirmed by user)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"highNote"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"DetectedNote?"})}),(0,s.jsx)(n.td,{children:"Locked high note (confirmed by user)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"result"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"VocalRangeResult?"})}),(0,s.jsx)(n.td,{children:"Final result when complete"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"error"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"String?"})}),(0,s.jsx)(n.td,{children:"Error message if detection failed"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"vocalrangephase",children:"VocalRangePhase"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Phase"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"IDLE"})}),(0,s.jsx)(n.td,{children:"Session not started"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"COUNTDOWN"})}),(0,s.jsx)(n.td,{children:"Countdown before detection"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"DETECTING_LOW"})}),(0,s.jsx)(n.td,{children:"Detecting lowest comfortable note"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"TRANSITION"})}),(0,s.jsx)(n.td,{children:"Transition between low and high"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"DETECTING_HIGH"})}),(0,s.jsx)(n.td,{children:"Detecting highest comfortable note"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"COMPLETE"})}),(0,s.jsx)(n.td,{children:"Detection complete, results available"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"CANCELLED"})}),(0,s.jsx)(n.td,{children:"Detection cancelled or failed"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"vocalrangeresult",children:"VocalRangeResult"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"low"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"VocalPitch"})}),(0,s.jsx)(n.td,{children:"Lowest detected note"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"high"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"VocalPitch"})}),(0,s.jsx)(n.td,{children:"Highest detected note"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"octaves"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Float"})}),(0,s.jsx)(n.td,{children:"Range in octaves"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"semitones"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Int"})}),(0,s.jsx)(n.td,{children:"Range in semitones"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"naturalShruti"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"VocalPitch"})}),(0,s.jsx)(n.td,{children:"Calculated natural key (Sa) for Indian Classical music"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"session-methods",children:"Session Methods"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Method"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"addAudio(samples, sampleRate)"})}),(0,s.jsx)(n.td,{children:"Feed audio samples. Resamples to 16kHz internally."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"start()"})}),(0,s.jsx)(n.td,{children:"Start auto-flow detection"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"confirmNote()"})}),(0,s.jsx)(n.td,{children:"Lock current best note and advance to next phase"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"cancel()"})}),(0,s.jsx)(n.td,{children:"Cancel the current session"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"reset()"})}),(0,s.jsx)(n.td,{children:"Reset to start a new session"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"release()"})}),(0,s.jsx)(n.td,{children:"Release all resources"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"manual-flow-control",children:"Manual Flow Control"}),"\n",(0,s.jsx)(n.p,{children:"For custom UIs that don't use the auto-flow:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:"val config = VocalRangeSessionConfig(autoFlow = false)\r\nval session = VocalRangeSession.create(config, detector = CalibraPitch.createDetector())\r\n\r\nsession.startPhase(VocalRangePhase.DETECTING_LOW)\r\n// ... feed audio ...\r\nsession.advancePhase()  // Move to DETECTING_HIGH\r\n// ... feed audio ...\r\nsession.complete()\n"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Method"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"startPhase(phase)"})}),(0,s.jsx)(n.td,{children:"Start a specific detection phase"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"advancePhase()"})}),(0,s.jsx)(n.td,{children:"Advance to the next phase"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"complete()"})}),(0,s.jsx)(n.td,{children:"Finalize and calculate result"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"./pitch",children:"CalibraPitch"})," \u2014 Real-time pitch detection used by range analyzer"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"./live-eval",children:"CalibraLiveEval"})," \u2014 Evaluate singing against a reference"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"./speaking-pitch",children:"CalibraSpeakingPitch"})," \u2014 Detect speaking voice pitch"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453(e,n,d){d.d(n,{R:()=>i,x:()=>l});var t=d(6540);const s={},r=t.createContext(s);function i(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);