"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[5906],{4487(e,r,n){n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"sonix/recorder","title":"SonixRecorder","description":"Capture microphone input and save recordings as M4A, MP3, or WAV files with real-time audio level monitoring.","source":"@site/docs/sonix/recorder.md","sourceDirName":"sonix","slug":"/sonix/recorder","permalink":"/voxatrace/sonix/recorder","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"SonixPlayer","permalink":"/voxatrace/sonix/player"},"next":{"title":"SonixMixer","permalink":"/voxatrace/sonix/mixer"}}');var d=n(4848),t=n(8453);const l={sidebar_position:3},s="SonixRecorder",c={},o=[{value:"Quick Start",id:"quick-start",level:2},{value:"Kotlin",id:"kotlin",level:3},{value:"Swift",id:"swift",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Presets",id:"presets",level:3},{value:"Builder",id:"builder",level:3},{value:"Kotlin",id:"kotlin-1",level:4},{value:"Swift",id:"swift-1",level:4},{value:"Config Properties",id:"config-properties",level:3},{value:"Callbacks",id:"callbacks",level:3},{value:"Creating a Recorder",id:"creating-a-recorder",level:2},{value:"With Output Path",id:"with-output-path",level:3},{value:"With Temporary Path",id:"with-temporary-path",level:3},{value:"Recording Controls",id:"recording-controls",level:2},{value:"Recording State",id:"recording-state",level:2},{value:"Observing State",id:"observing-state",level:2},{value:"Kotlin (StateFlow)",id:"kotlin-stateflow",level:3},{value:"Swift (Observers)",id:"swift-observers",level:3},{value:"Swift (Combine)",id:"swift-combine",level:3},{value:"StateFlows",id:"stateflows",level:3},{value:"Properties",id:"properties",level:3},{value:"Real-time Audio Access",id:"real-time-audio-access",level:2},{value:"Kotlin",id:"kotlin-2",level:3},{value:"Swift (Resampled Stream)",id:"swift-resampled-stream",level:3},{value:"Segment Recording",id:"segment-recording",level:2},{value:"Playback Sync",id:"playback-sync",level:2},{value:"Listener Interface",id:"listener-interface",level:2},{value:"Common Patterns",id:"common-patterns",level:2},{value:"Recording ViewModel",id:"recording-viewmodel",level:3},{value:"Platform Notes",id:"platform-notes",level:2},{value:"Next Steps",id:"next-steps",level:2}];function a(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(r.header,{children:(0,d.jsx)(r.h1,{id:"sonixrecorder",children:"SonixRecorder"})}),"\n",(0,d.jsx)(r.p,{children:"Capture microphone input and save recordings as M4A, MP3, or WAV files with real-time audio level monitoring."}),"\n",(0,d.jsx)(r.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,d.jsx)(r.h3,{id:"kotlin",children:"Kotlin"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-kotlin",children:'val recorder = SonixRecorder.create("/path/to/output.m4a")\r\nrecorder.start()\r\n// ... user sings ...\r\nrecorder.stop()\r\nrecorder.release()\n'})}),"\n",(0,d.jsx)(r.h3,{id:"swift",children:"Swift"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-swift",children:'let recorder = SonixRecorder.create(outputPath: "/path/to/output.m4a")\r\nrecorder.start()\r\n// ... user sings ...\r\nrecorder.stop()\r\nrecorder.release()\n'})}),"\n",(0,d.jsx)(r.h2,{id:"configuration",children:"Configuration"}),"\n",(0,d.jsx)(r.h3,{id:"presets",children:"Presets"}),"\n",(0,d.jsxs)(r.table,{children:[(0,d.jsx)(r.thead,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.th,{children:"Preset"}),(0,d.jsx)(r.th,{children:"Kotlin"}),(0,d.jsx)(r.th,{children:"Swift"}),(0,d.jsx)(r.th,{children:"Sample Rate"}),(0,d.jsx)(r.th,{children:"Channels"}),(0,d.jsx)(r.th,{children:"Bitrate"})]})}),(0,d.jsxs)(r.tbody,{children:[(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:"Voice"}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"SonixRecorderConfig.VOICE"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:".voice"})}),(0,d.jsx)(r.td,{children:"16 kHz"}),(0,d.jsx)(r.td,{children:"Mono"}),(0,d.jsx)(r.td,{children:"64 kbps"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:"Standard"}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"SonixRecorderConfig.STANDARD"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:".standard"})}),(0,d.jsx)(r.td,{children:"44.1 kHz"}),(0,d.jsx)(r.td,{children:"Stereo"}),(0,d.jsx)(r.td,{children:"128 kbps"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:"High"}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"SonixRecorderConfig.HIGH"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:".high"})}),(0,d.jsx)(r.td,{children:"48 kHz"}),(0,d.jsx)(r.td,{children:"Stereo"}),(0,d.jsx)(r.td,{children:"256 kbps"})]})]})]}),"\n",(0,d.jsx)(r.h3,{id:"builder",children:"Builder"}),"\n",(0,d.jsx)(r.h4,{id:"kotlin-1",children:"Kotlin"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-kotlin",children:'val config = SonixRecorderConfig.Builder()\r\n    .preset(SonixRecorderConfig.STANDARD)\r\n    .format(AudioFormat.MP3)\r\n    .echoCancellation(true)\r\n    .onRecordingStopped { path -> println("Saved to: $path") }\r\n    .build()\r\n\r\nval recorder = SonixRecorder.create("/path/to/output.mp3", config)\n'})}),"\n",(0,d.jsx)(r.h4,{id:"swift-1",children:"Swift"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-swift",children:'let config = SonixRecorderConfig.Builder()\r\n    .preset(.standard)\r\n    .format(.mp3)\r\n    .echoCancellation(true)\r\n    .onRecordingStopped { path in print("Saved to: \\(path)") }\r\n    .build()\r\n\r\nlet recorder = SonixRecorder.create(outputPath: "/path/to/output.mp3", config: config)\n'})}),"\n",(0,d.jsx)(r.h3,{id:"config-properties",children:"Config Properties"}),"\n",(0,d.jsxs)(r.table,{children:[(0,d.jsx)(r.thead,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.th,{children:"Property"}),(0,d.jsx)(r.th,{children:"Type"}),(0,d.jsx)(r.th,{children:"Default"}),(0,d.jsx)(r.th,{children:"Description"})]})}),(0,d.jsxs)(r.tbody,{children:[(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"format"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"AudioFormat"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"M4A"})}),(0,d.jsx)(r.td,{children:"Output format (M4A, MP3, WAV)"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"sampleRate"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Int"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"16000"})}),(0,d.jsx)(r.td,{children:"Sample rate in Hz"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"channels"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Int"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"1"})}),(0,d.jsx)(r.td,{children:"1 = mono, 2 = stereo"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"bitrate"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Int"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"64000"})}),(0,d.jsx)(r.td,{children:"Encoder bitrate (bps)"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"echoCancellation"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Boolean"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"false"})}),(0,d.jsx)(r.td,{children:"Enable acoustic echo cancellation"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"audioBufferSizeMs"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Int"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"40"})}),(0,d.jsx)(r.td,{children:"Audio capture buffer size (ms)"})]})]})]}),"\n",(0,d.jsx)(r.h3,{id:"callbacks",children:"Callbacks"}),"\n",(0,d.jsxs)(r.table,{children:[(0,d.jsx)(r.thead,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.th,{children:"Builder Method"}),(0,d.jsx)(r.th,{children:"Signature"}),(0,d.jsx)(r.th,{children:"Description"})]})}),(0,d.jsxs)(r.tbody,{children:[(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"onRecordingStarted"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"() -> Unit"})}),(0,d.jsx)(r.td,{children:"Recording started"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"onRecordingStopped"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"(outputPath: String) -> Unit"})}),(0,d.jsx)(r.td,{children:"Recording saved"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"onError"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"(message: String) -> Unit"})}),(0,d.jsx)(r.td,{children:"Error occurred"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"onLevelUpdate"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"(level: Float) -> Unit"})}),(0,d.jsx)(r.td,{children:"Audio level changed (0.0\u20131.0)"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"onStateChange"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"(RecordingState) -> Unit"})}),(0,d.jsx)(r.td,{children:"State machine transition"})]})]})]}),"\n",(0,d.jsx)(r.h2,{id:"creating-a-recorder",children:"Creating a Recorder"}),"\n",(0,d.jsx)(r.h3,{id:"with-output-path",children:"With Output Path"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-kotlin",children:'val recorder = SonixRecorder.create(\r\n    outputPath = "/path/to/output.m4a",\r\n    config = SonixRecorderConfig.VOICE,\r\n    audioSession = AudioMode.RECORDING\r\n)\n'})}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-swift",children:'let recorder = SonixRecorder.create(\r\n    outputPath: "/path/to/output.m4a",\r\n    config: .voice,\r\n    audioSession: .recording\r\n)\n'})}),"\n",(0,d.jsx)(r.h3,{id:"with-temporary-path",children:"With Temporary Path"}),"\n",(0,d.jsx)(r.p,{children:"For cases where you don't need a specific output location (e.g., real-time analysis):"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-kotlin",children:"val recorder = SonixRecorder.createTemporary()\n"})}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-swift",children:"let recorder = SonixRecorder.createTemporary()\n"})}),"\n",(0,d.jsx)(r.h2,{id:"recording-controls",children:"Recording Controls"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-kotlin",children:"recorder.start()    // Begin recording\r\nrecorder.stop()     // Stop and save to file\r\nrecorder.release()  // Release all resources\n"})}),"\n",(0,d.jsx)(r.h2,{id:"recording-state",children:"Recording State"}),"\n",(0,d.jsx)(r.p,{children:"The recorder follows a state machine:"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-text",children:"Idle \u2192 Starting \u2192 Recording \u2192 Stopping \u2192 Encoding \u2192 Finished\r\n                                                   \u2198 Error\n"})}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-kotlin",children:"sealed class RecordingState {\r\n    object Idle\r\n    object Starting\r\n    data class Recording(val durationMs: Long)\r\n    object Stopping\r\n    object Encoding\r\n    data class Finished(val outputPath: String?)\r\n    data class Error(val message: String)\r\n}\n"})}),"\n",(0,d.jsx)(r.h2,{id:"observing-state",children:"Observing State"}),"\n",(0,d.jsx)(r.h3,{id:"kotlin-stateflow",children:"Kotlin (StateFlow)"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-kotlin",children:"// Recording status\r\nrecorder.isRecording.collect { recording ->\r\n    recordButton.isEnabled = !recording\r\n    stopButton.isEnabled = recording\r\n}\r\n\r\n// Duration\r\nrecorder.duration.collect { durationMs ->\r\n    timerLabel.text = formatTime(durationMs)\r\n}\r\n\r\n// Audio level (for VU meter)\r\nrecorder.level.collect { level ->\r\n    vuMeter.setLevel(level)  // 0.0 to 1.0\r\n}\r\n\r\n// Full state machine\r\nrecorder.state.collect { state ->\r\n    when (state) {\r\n        is RecordingState.Recording -> showRecording(state.durationMs)\r\n        is RecordingState.Encoding -> showEncoding()\r\n        is RecordingState.Finished -> showDone(state.outputPath)\r\n        is RecordingState.Error -> showError(state.message)\r\n        else -> {}\r\n    }\r\n}\n"})}),"\n",(0,d.jsx)(r.h3,{id:"swift-observers",children:"Swift (Observers)"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-swift",children:"let recordingTask = recorder.observeIsRecording { isRecording in\r\n    self.isRecording = isRecording\r\n}\r\n\r\nlet durationTask = recorder.observeDuration { durationMs in\r\n    self.durationMs = durationMs\r\n}\r\n\r\nlet levelTask = recorder.observeLevel { level in\r\n    self.audioLevel = level\r\n}\r\n\r\n// Cancel when done\r\nrecordingTask.cancel()\r\ndurationTask.cancel()\r\nlevelTask.cancel()\n"})}),"\n",(0,d.jsx)(r.h3,{id:"swift-combine",children:"Swift (Combine)"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-swift",children:"recorder.isRecordingPublisher\r\n    .receive(on: DispatchQueue.main)\r\n    .sink { self.isRecording = $0 }\r\n    .store(in: &cancellables)\r\n\r\nrecorder.levelPublisher\r\n    .receive(on: DispatchQueue.main)\r\n    .sink { self.audioLevel = $0 }\r\n    .store(in: &cancellables)\n"})}),"\n",(0,d.jsx)(r.h3,{id:"stateflows",children:"StateFlows"}),"\n",(0,d.jsxs)(r.table,{children:[(0,d.jsx)(r.thead,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.th,{children:"StateFlow"}),(0,d.jsx)(r.th,{children:"Type"}),(0,d.jsx)(r.th,{children:"Description"})]})}),(0,d.jsxs)(r.tbody,{children:[(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"isRecording"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"StateFlow<Boolean>"})}),(0,d.jsx)(r.td,{children:"Whether currently recording"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"duration"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"StateFlow<Long>"})}),(0,d.jsx)(r.td,{children:"Recording duration in milliseconds"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"level"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"StateFlow<Float>"})}),(0,d.jsx)(r.td,{children:"Audio level (0.0 = silence, 1.0 = loud)"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"error"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"StateFlow<SonixError?>"})}),(0,d.jsx)(r.td,{children:"Error state"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"state"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"StateFlow<RecordingState>"})}),(0,d.jsx)(r.td,{children:"Full state machine"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"audioBuffers"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"SharedFlow<AudioBuffer>"})}),(0,d.jsx)(r.td,{children:"Raw audio buffers for real-time processing"})]})]})]}),"\n",(0,d.jsx)(r.h3,{id:"properties",children:"Properties"}),"\n",(0,d.jsxs)(r.table,{children:[(0,d.jsx)(r.thead,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.th,{children:"Property"}),(0,d.jsx)(r.th,{children:"Type"}),(0,d.jsx)(r.th,{children:"Description"})]})}),(0,d.jsxs)(r.tbody,{children:[(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"actualSampleRate"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Int"})}),(0,d.jsx)(r.td,{children:"Hardware sample rate (may differ from configured)"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"bufferPoolAvailable"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Int"})}),(0,d.jsx)(r.td,{children:"Buffers available in pool"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"bufferPoolWasExhausted"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Boolean"})}),(0,d.jsx)(r.td,{children:"Whether pool was ever exhausted"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"latestBuffer"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"AudioBuffer?"})}),(0,d.jsx)(r.td,{children:"Most recent audio buffer"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"synchronizedTimeMs"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Long"})}),(0,d.jsx)(r.td,{children:"Playback-synchronized time"})]})]})]}),"\n",(0,d.jsx)(r.h2,{id:"real-time-audio-access",children:"Real-time Audio Access"}),"\n",(0,d.jsx)(r.p,{children:"Access raw audio buffers for visualization or analysis:"}),"\n",(0,d.jsx)(r.h3,{id:"kotlin-2",children:"Kotlin"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-kotlin",children:"recorder.audioBuffers.collect { buffer ->\r\n    val samples = buffer.toFloatArray()\r\n    pitchDetector.detect(samples, buffer.sampleRate)\r\n}\n"})}),"\n",(0,d.jsx)(r.h3,{id:"swift-resampled-stream",children:"Swift (Resampled Stream)"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-swift",children:"for await samples in recorder.audioBuffers(resampledTo: 16000) {\r\n    pitchDetector.detect(samples: samples, sampleRate: 16000)\r\n}\n"})}),"\n",(0,d.jsx)(r.h2,{id:"segment-recording",children:"Segment Recording"}),"\n",(0,d.jsx)(r.p,{children:"Record specific portions within a session (for practice apps):"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-kotlin",children:'// Enable in config\r\nval config = SonixRecorderConfig.Builder()\r\n    .enableSegmentRecording(outputDirectory = "/path/to/segments/")\r\n    .build()\r\n\r\nval recorder = SonixRecorder.create("/path/to/full.m4a", config)\r\nrecorder.start()\r\n\r\n// Record a segment\r\nrecorder.startRecordingSegment(segmentIndex = 0)\r\n// ... user performs section ...\r\nval segmentPath = recorder.stopRecordingSegment(segmentIndex = 0)\r\n\r\n// Query segments\r\nval segments: List<SegmentInfo> = recorder.getRecordedSegments()\r\nrecorder.clearSegments()  // Clear for retry\n'})}),"\n",(0,d.jsx)(r.h2,{id:"playback-sync",children:"Playback Sync"}),"\n",(0,d.jsx)(r.p,{children:"Synchronize recording with a backing track for karaoke:"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-kotlin",children:'val player = SonixPlayer.create("backing-track.mp3")\r\n\r\nval config = SonixRecorderConfig.Builder()\r\n    .playbackSyncProvider(player.asPlaybackInfoProvider)\r\n    .build()\r\n\r\nval recorder = SonixRecorder.create("recording.m4a", config)\r\n\r\nplayer.play()\r\nrecorder.start()\r\n\r\n// Recording timestamps align with playback position\r\nval syncedTime = recorder.synchronizedTimeMs\n'})}),"\n",(0,d.jsx)(r.h2,{id:"listener-interface",children:"Listener Interface"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-kotlin",children:'recorder.setRecordingListener(object : SonixRecorder.RecordingListener {\r\n    override fun onRecordingStarted() { println("Started") }\r\n    override fun onRecordingStopped(outputPath: String) { println("Saved: $outputPath") }\r\n    override fun onStateChanged(state: RecordingState) { updateUI(state) }\r\n    override fun onLevelUpdate(level: Float) { vuMeter.setLevel(level) }\r\n    override fun onDurationUpdate(durationMs: Long) { updateTimer(durationMs) }\r\n    override fun onError(message: String) { showError(message) }\r\n    override fun onSegmentSaved(segmentIndex: Int, filePath: String) {\r\n        println("Segment $segmentIndex saved to $filePath")\r\n    }\r\n})\n'})}),"\n",(0,d.jsx)(r.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,d.jsx)(r.h3,{id:"recording-viewmodel",children:"Recording ViewModel"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-kotlin",children:"class RecordingViewModel : ViewModel() {\r\n    private var recorder: SonixRecorder? = null\r\n\r\n    val isRecording = MutableStateFlow(false)\r\n    val duration = MutableStateFlow(0L)\r\n    val audioLevel = MutableStateFlow(0f)\r\n\r\n    fun startRecording(outputPath: String) {\r\n        val config = SonixRecorderConfig.Builder()\r\n            .preset(SonixRecorderConfig.VOICE)\r\n            .format(AudioFormat.MP3)\r\n            .build()\r\n\r\n        recorder = SonixRecorder.create(outputPath, config)\r\n\r\n        viewModelScope.launch { recorder!!.isRecording.collect { isRecording.value = it } }\r\n        viewModelScope.launch { recorder!!.duration.collect { duration.value = it } }\r\n        viewModelScope.launch { recorder!!.level.collect { audioLevel.value = it } }\r\n\r\n        recorder!!.start()\r\n    }\r\n\r\n    fun stopRecording() {\r\n        recorder?.stop()\r\n    }\r\n\r\n    override fun onCleared() {\r\n        recorder?.release()\r\n    }\r\n}\n"})}),"\n",(0,d.jsx)(r.h2,{id:"platform-notes",children:"Platform Notes"}),"\n",(0,d.jsxs)(r.ul,{children:["\n",(0,d.jsxs)(r.li,{children:[(0,d.jsx)(r.strong,{children:"iOS"}),": Requires microphone permission in Info.plist. Hardware sample rate may differ from requested \u2014 check ",(0,d.jsx)(r.code,{children:"actualSampleRate"}),"."]}),"\n",(0,d.jsxs)(r.li,{children:[(0,d.jsx)(r.strong,{children:"Android"}),": Requires ",(0,d.jsx)(r.code,{children:"RECORD_AUDIO"})," permission. Audio focus handled automatically."]}),"\n"]}),"\n",(0,d.jsx)(r.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,d.jsxs)(r.ul,{children:["\n",(0,d.jsxs)(r.li,{children:[(0,d.jsx)(r.a,{href:"./player",children:"SonixPlayer"})," \u2014 Play recorded audio"]}),"\n",(0,d.jsxs)(r.li,{children:[(0,d.jsx)(r.a,{href:"./mixer",children:"SonixMixer"})," \u2014 Multi-track mixing with recorded audio"]}),"\n",(0,d.jsxs)(r.li,{children:[(0,d.jsx)(r.a,{href:"./encoder",children:"SonixEncoder"})," \u2014 Encode audio to different formats"]}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,d.jsx)(r,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}},8453(e,r,n){n.d(r,{R:()=>l,x:()=>s});var i=n(6540);const d={},t=i.createContext(d);function l(e){const r=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function s(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:l(e.components),i.createElement(t.Provider,{value:r},e.children)}}}]);