"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[9535],{3238(e,r,n){n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"sonix/metronome","title":"SonixMetronome","description":"Programmable metronome with distinct downbeat and beat sounds, configurable BPM, and visual beat tracking.","source":"@site/docs/sonix/metronome.md","sourceDirName":"sonix","slug":"/sonix/metronome","permalink":"/sonix/metronome","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"docsSidebar","previous":{"title":"SonixMixer","permalink":"/sonix/mixer"},"next":{"title":"SonixDecoder","permalink":"/sonix/decoder"}}');var l=n(4848),i=n(8453);const s={sidebar_position:5},d="SonixMetronome",o={},a=[{value:"Quick Start",id:"quick-start",level:2},{value:"Kotlin",id:"kotlin",level:3},{value:"Swift",id:"swift",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Factory Method",id:"factory-method",level:3},{value:"Builder",id:"builder",level:3},{value:"Kotlin",id:"kotlin-1",level:4},{value:"Swift",id:"swift-1",level:4},{value:"Builder Parameters",id:"builder-parameters",level:3},{value:"Playback Controls",id:"playback-controls",level:2},{value:"Runtime Adjustments",id:"runtime-adjustments",level:2},{value:"Observing State",id:"observing-state",level:2},{value:"Kotlin (StateFlow)",id:"kotlin-stateflow",level:3},{value:"Swift (Observers)",id:"swift-observers",level:3},{value:"Swift (Combine)",id:"swift-combine",level:3},{value:"StateFlows",id:"stateflows",level:3},{value:"Properties",id:"properties",level:3},{value:"Common Patterns",id:"common-patterns",level:2},{value:"Metronome ViewModel",id:"metronome-viewmodel",level:3},{value:"Next Steps",id:"next-steps",level:2}];function c(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.header,{children:(0,l.jsx)(r.h1,{id:"sonixmetronome",children:"SonixMetronome"})}),"\n",(0,l.jsx)(r.p,{children:"Programmable metronome with distinct downbeat and beat sounds, configurable BPM, and visual beat tracking."}),"\n",(0,l.jsx)(r.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,l.jsx)(r.h3,{id:"kotlin",children:"Kotlin"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-kotlin",children:'val metronome = SonixMetronome.create(\r\n    samaSamplePath = "/path/to/sama.wav",\r\n    beatSamplePath = "/path/to/beat.wav"\r\n)\r\n\r\n// Wait for samples to load, then start\r\nmetronome.isInitialized.collect { ready ->\r\n    if (ready) metronome.start()\r\n}\r\n\r\n// Later...\r\nmetronome.stop()\r\nmetronome.release()\n'})}),"\n",(0,l.jsx)(r.h3,{id:"swift",children:"Swift"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-swift",children:'let metronome = SonixMetronome.create(\r\n    samaSamplePath: "/path/to/sama.wav",\r\n    beatSamplePath: "/path/to/beat.wav"\r\n)\r\n\r\n// Wait for samples to load, then start\r\nlet initTask = metronome.observeIsInitialized { ready in\r\n    if ready { metronome.start() }\r\n}\r\n\r\n// Later...\r\nmetronome.stop()\r\nmetronome.release()\n'})}),"\n",(0,l.jsx)(r.h2,{id:"configuration",children:"Configuration"}),"\n",(0,l.jsx)(r.h3,{id:"factory-method",children:"Factory Method"}),"\n",(0,l.jsxs)(r.table,{children:[(0,l.jsx)(r.thead,{children:(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.th,{children:"Parameter"}),(0,l.jsx)(r.th,{children:"Type"}),(0,l.jsx)(r.th,{children:"Default"}),(0,l.jsx)(r.th,{children:"Description"})]})}),(0,l.jsxs)(r.tbody,{children:[(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"samaSamplePath"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"String"})}),(0,l.jsx)(r.td,{children:"\u2014"}),(0,l.jsx)(r.td,{children:"Path to downbeat audio sample (required)"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"beatSamplePath"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"String"})}),(0,l.jsx)(r.td,{children:"\u2014"}),(0,l.jsx)(r.td,{children:"Path to regular beat audio sample (required)"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"bpm"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"Float"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"120"})}),(0,l.jsx)(r.td,{children:"Initial tempo (30\u2013300)"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"beatsPerCycle"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"Int"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"4"})}),(0,l.jsx)(r.td,{children:"Beats per cycle"})]})]})]}),"\n",(0,l.jsx)(r.h3,{id:"builder",children:"Builder"}),"\n",(0,l.jsx)(r.p,{children:"For advanced configuration with callbacks:"}),"\n",(0,l.jsx)(r.h4,{id:"kotlin-1",children:"Kotlin"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-kotlin",children:'val metronome = SonixMetronome.Builder()\r\n    .samaSamplePath("/path/to/sama.wav")\r\n    .beatSamplePath("/path/to/beat.wav")\r\n    .bpm(120f)\r\n    .beatsPerCycle(4)\r\n    .volume(0.8f)\r\n    .onBeat { beatIndex -> updateBeatIndicator(beatIndex) }\r\n    .onError { error -> showError(error) }\r\n    .build()\n'})}),"\n",(0,l.jsx)(r.h4,{id:"swift-1",children:"Swift"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-swift",children:'let metronome = SonixMetronome.Builder()\r\n    .samaSamplePath(path: "/path/to/sama.wav")\r\n    .beatSamplePath(path: "/path/to/beat.wav")\r\n    .bpm(bpm: 120)\r\n    .beatsPerCycle(count: 4)\r\n    .volume(volume: 0.8)\r\n    .build()\n'})}),"\n",(0,l.jsx)(r.h3,{id:"builder-parameters",children:"Builder Parameters"}),"\n",(0,l.jsxs)(r.table,{children:[(0,l.jsx)(r.thead,{children:(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.th,{children:"Method"}),(0,l.jsx)(r.th,{children:"Type"}),(0,l.jsx)(r.th,{children:"Default"}),(0,l.jsx)(r.th,{children:"Description"})]})}),(0,l.jsxs)(r.tbody,{children:[(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"samaSamplePath"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"String"})}),(0,l.jsx)(r.td,{children:"\u2014"}),(0,l.jsx)(r.td,{children:"Downbeat audio path (required)"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"beatSamplePath"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"String"})}),(0,l.jsx)(r.td,{children:"\u2014"}),(0,l.jsx)(r.td,{children:"Beat audio path (required)"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"bpm"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"Float"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"120"})}),(0,l.jsx)(r.td,{children:"Tempo (clamped 30\u2013300)"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"beatsPerCycle"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"Int"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"4"})}),(0,l.jsx)(r.td,{children:"Beats per cycle"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"volume"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"Float"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"0.8"})}),(0,l.jsx)(r.td,{children:"Initial volume (clamped 0\u20131)"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"onBeat"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"(beatIndex: Int) -> Unit"})}),(0,l.jsx)(r.td,{children:"\u2014"}),(0,l.jsx)(r.td,{children:"Called on each beat"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"onError"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"(error: String) -> Unit"})}),(0,l.jsx)(r.td,{children:"\u2014"}),(0,l.jsx)(r.td,{children:"Called on error"})]})]})]}),"\n",(0,l.jsx)(r.h2,{id:"playback-controls",children:"Playback Controls"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-kotlin",children:"metronome.start()         // Start (only works when isInitialized is true)\r\nmetronome.stop()          // Stop\r\nmetronome.release()       // Release all resources\n"})}),"\n",(0,l.jsx)(r.h2,{id:"runtime-adjustments",children:"Runtime Adjustments"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-kotlin",children:"metronome.setBpm(140f)     // Change tempo (30\u2013300)\r\nmetronome.volume = 0.5f    // Change volume (0.0\u20131.0)\n"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-swift",children:"metronome.setBpm(bpm: 140)\r\nmetronome.volume = 0.5\n"})}),"\n",(0,l.jsxs)(r.table,{children:[(0,l.jsx)(r.thead,{children:(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.th,{children:"Property/Method"}),(0,l.jsx)(r.th,{children:"Range"}),(0,l.jsx)(r.th,{children:"Notes"})]})}),(0,l.jsxs)(r.tbody,{children:[(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"setBpm(bpm)"})}),(0,l.jsx)(r.td,{children:"30\u2013300"}),(0,l.jsx)(r.td,{children:"Takes effect on next beat"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"volume"})}),(0,l.jsx)(r.td,{children:"0.0\u20131.0"}),(0,l.jsx)(r.td,{children:"Immediate effect"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"beatsPerCycle"})}),(0,l.jsx)(r.td,{children:"\u2014"}),(0,l.jsx)(r.td,{children:"Read-only; set at creation time"})]})]})]}),"\n",(0,l.jsx)(r.h2,{id:"observing-state",children:"Observing State"}),"\n",(0,l.jsx)(r.h3,{id:"kotlin-stateflow",children:"Kotlin (StateFlow)"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-kotlin",children:'metronome.isInitialized.collect { ready ->\r\n    startButton.isEnabled = ready\r\n}\r\n\r\nmetronome.isPlaying.collect { playing ->\r\n    playButton.icon = if (playing) stopIcon else playIcon\r\n}\r\n\r\nmetronome.currentBeat.collect { beat ->\r\n    highlightBeat(beat)  // 0-based index\r\n}\r\n\r\nmetronome.bpm.collect { currentBpm ->\r\n    bpmLabel.text = "${currentBpm.toInt()} BPM"\r\n}\r\n\r\nmetronome.error.collect { error ->\r\n    error?.let { showError(it.message) }\r\n}\n'})}),"\n",(0,l.jsx)(r.h3,{id:"swift-observers",children:"Swift (Observers)"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-swift",children:"let beatTask = metronome.observeCurrentBeat { beat in\r\n    self.currentBeat = beat\r\n}\r\n\r\nlet playingTask = metronome.observeIsPlaying { isPlaying in\r\n    self.isPlaying = isPlaying\r\n}\r\n\r\nlet initTask = metronome.observeIsInitialized { ready in\r\n    self.isReady = ready\r\n}\r\n\r\nlet bpmTask = metronome.observeBpm { bpm in\r\n    self.currentBpm = bpm\r\n}\r\n\r\nlet errorTask = metronome.observeError { error in\r\n    if let error = error { self.showError(error.message) }\r\n}\n"})}),"\n",(0,l.jsx)(r.h3,{id:"swift-combine",children:"Swift (Combine)"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-swift",children:"metronome.currentBeatPublisher\r\n    .receive(on: DispatchQueue.main)\r\n    .sink { self.currentBeat = $0 }\r\n    .store(in: &cancellables)\r\n\r\nmetronome.isPlayingPublisher\r\n    .receive(on: DispatchQueue.main)\r\n    .sink { self.isPlaying = $0 }\r\n    .store(in: &cancellables)\n"})}),"\n",(0,l.jsx)(r.h3,{id:"stateflows",children:"StateFlows"}),"\n",(0,l.jsxs)(r.table,{children:[(0,l.jsx)(r.thead,{children:(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.th,{children:"StateFlow"}),(0,l.jsx)(r.th,{children:"Type"}),(0,l.jsx)(r.th,{children:"Description"})]})}),(0,l.jsxs)(r.tbody,{children:[(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"currentBeat"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"StateFlow<Int>"})}),(0,l.jsx)(r.td,{children:"Current beat index (0-based, wraps at beatsPerCycle)"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"isPlaying"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"StateFlow<Boolean>"})}),(0,l.jsx)(r.td,{children:"Whether metronome is running"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"bpm"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"StateFlow<Float>"})}),(0,l.jsx)(r.td,{children:"Current tempo"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"isInitialized"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"StateFlow<Boolean>"})}),(0,l.jsx)(r.td,{children:"Whether samples are loaded and ready"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"error"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"StateFlow<SonixError?>"})}),(0,l.jsx)(r.td,{children:"Error state"})]})]})]}),"\n",(0,l.jsx)(r.h3,{id:"properties",children:"Properties"}),"\n",(0,l.jsxs)(r.table,{children:[(0,l.jsx)(r.thead,{children:(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.th,{children:"Property"}),(0,l.jsx)(r.th,{children:"Type"}),(0,l.jsx)(r.th,{children:"Description"})]})}),(0,l.jsxs)(r.tbody,{children:[(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"beatsPerCycle"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"Int"})}),(0,l.jsx)(r.td,{children:"Number of beats per cycle (read-only)"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"volume"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"Float"})}),(0,l.jsx)(r.td,{children:"Current volume (0.0\u20131.0, mutable)"})]})]})]}),"\n",(0,l.jsx)(r.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,l.jsx)(r.h3,{id:"metronome-viewmodel",children:"Metronome ViewModel"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-kotlin",children:"class MetronomeViewModel : ViewModel() {\r\n    private var metronome: SonixMetronome? = null\r\n\r\n    val currentBeat = MutableStateFlow(0)\r\n    val isPlaying = MutableStateFlow(false)\r\n    val isReady = MutableStateFlow(false)\r\n\r\n    fun initialize(samaPath: String, beatPath: String) {\r\n        metronome = SonixMetronome.Builder()\r\n            .samaSamplePath(samaPath)\r\n            .beatSamplePath(beatPath)\r\n            .bpm(120f)\r\n            .beatsPerCycle(4)\r\n            .onBeat { beat -> currentBeat.value = beat }\r\n            .build()\r\n\r\n        viewModelScope.launch {\r\n            metronome!!.isInitialized.collect { isReady.value = it }\r\n        }\r\n        viewModelScope.launch {\r\n            metronome!!.isPlaying.collect { isPlaying.value = it }\r\n        }\r\n    }\r\n\r\n    fun togglePlayback() {\r\n        val m = metronome ?: return\r\n        if (m.isPlaying.value) m.stop() else m.start()\r\n    }\r\n\r\n    fun setBpm(bpm: Float) {\r\n        metronome?.setBpm(bpm)\r\n    }\r\n\r\n    override fun onCleared() {\r\n        metronome?.release()\r\n    }\r\n}\n"})}),"\n",(0,l.jsx)(r.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsxs)(r.li,{children:[(0,l.jsx)(r.a,{href:"./player",children:"SonixPlayer"})," \u2014 Play audio files"]}),"\n",(0,l.jsxs)(r.li,{children:[(0,l.jsx)(r.a,{href:"./mixer",children:"SonixMixer"})," \u2014 Multi-track mixing"]}),"\n",(0,l.jsxs)(r.li,{children:[(0,l.jsx)(r.a,{href:"./recorder",children:"SonixRecorder"})," \u2014 Record alongside the metronome"]}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,l.jsx)(r,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},8453(e,r,n){n.d(r,{R:()=>s,x:()=>d});var t=n(6540);const l={},i=t.createContext(l);function s(e){const r=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),t.createElement(i.Provider,{value:r},e.children)}}}]);