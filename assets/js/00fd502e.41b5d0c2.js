"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[501],{8225(e,n,r){r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"getting-started/android-quickstart","title":"Android Quickstart","description":"Build a simple pitch detector in 5 minutes.","source":"@site/docs/getting-started/android-quickstart.md","sourceDirName":"getting-started","slug":"/getting-started/android-quickstart","permalink":"/voxatrace/getting-started/android-quickstart","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"Installation","permalink":"/voxatrace/getting-started/installation"},"next":{"title":"iOS Quickstart","permalink":"/voxatrace/getting-started/ios-quickstart"}}');var i=r(4848),o=r(8453);const a={sidebar_position:2},s="Android Quickstart",c={},d=[{value:"What You&#39;ll Build",id:"what-youll-build",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Step 1: Request Microphone Permission",id:"step-1-request-microphone-permission",level:2},{value:"Step 2: Create the Pitch Detector",id:"step-2-create-the-pitch-detector",level:2},{value:"What You&#39;ll See",id:"what-youll-see",level:2},{value:"Step 3: Add UI (Optional)",id:"step-3-add-ui-optional",level:2},{value:"Complete Example with Compose",id:"complete-example-with-compose",level:2},{value:"Next Steps",id:"next-steps",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"android-quickstart",children:"Android Quickstart"})}),"\n",(0,i.jsx)(n.p,{children:"Build a simple pitch detector in 5 minutes."}),"\n",(0,i.jsx)(n.h2,{id:"what-youll-build",children:"What You'll Build"}),"\n",(0,i.jsx)(n.p,{children:"A minimal app that:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Records audio from the microphone"}),"\n",(0,i.jsx)(n.li,{children:"Detects pitch in real-time"}),"\n",(0,i.jsx)(n.li,{children:"Displays the detected note"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Android Studio Arctic Fox or later"}),"\n",(0,i.jsxs)(n.li,{children:["VoxaTrace installed (see ",(0,i.jsx)(n.a,{href:"./installation",children:"Installation"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"Microphone permission granted"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"step-1-request-microphone-permission",children:"Step 1: Request Microphone Permission"}),"\n",(0,i.jsx)(n.p,{children:"In your Activity or Fragment:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:"import android.Manifest\r\nimport android.content.pm.PackageManager\r\nimport androidx.core.app.ActivityCompat\r\nimport androidx.core.content.ContextCompat\r\n\r\nclass MainActivity : AppCompatActivity() {\r\n    private val RECORD_AUDIO_PERMISSION = 1\r\n\r\n    override fun onCreate(savedInstanceState: Bundle?) {\r\n        super.onCreate(savedInstanceState)\r\n        requestMicrophonePermission()\r\n    }\r\n\r\n    private fun requestMicrophonePermission() {\r\n        if (ContextCompat.checkSelfPermission(this, Manifest.permission.RECORD_AUDIO)\r\n            != PackageManager.PERMISSION_GRANTED) {\r\n            ActivityCompat.requestPermissions(\r\n                this,\r\n                arrayOf(Manifest.permission.RECORD_AUDIO),\r\n                RECORD_AUDIO_PERMISSION\r\n            )\r\n        } else {\r\n            startPitchDetection()\r\n        }\r\n    }\r\n\r\n    override fun onRequestPermissionsResult(\r\n        requestCode: Int,\r\n        permissions: Array<String>,\r\n        grantResults: IntArray\r\n    ) {\r\n        super.onRequestPermissionsResult(requestCode, permissions, grantResults)\r\n        if (requestCode == RECORD_AUDIO_PERMISSION &&\r\n            grantResults.isNotEmpty() &&\r\n            grantResults[0] == PackageManager.PERMISSION_GRANTED) {\r\n            startPitchDetection()\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"step-2-create-the-pitch-detector",children:"Step 2: Create the Pitch Detector"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:'import com.musicmuni.voxatrace.calibra.CalibraPitch\r\nimport com.musicmuni.voxatrace.sonix.SonixRecorder\r\nimport com.musicmuni.voxatrace.sonix.SonixRecorderConfig\r\nimport kotlinx.coroutines.*\r\nimport kotlinx.coroutines.flow.collect\r\n\r\nclass MainActivity : AppCompatActivity() {\r\n    private var recorder: SonixRecorder? = null\r\n    private var detector: CalibraPitch.Detector? = null\r\n    private val scope = CoroutineScope(Dispatchers.Main + SupervisorJob())\r\n\r\n    private fun startPitchDetection() {\r\n        scope.launch {\r\n            // Create recorder with default voice settings\r\n            recorder = SonixRecorder.createTemporary(SonixRecorderConfig.VOICE)\r\n\r\n            // Create pitch detector with default settings\r\n            detector = CalibraPitch.createDetector()\r\n\r\n            // Start recording\r\n            recorder?.start()\r\n\r\n            // Process audio buffers\r\n            recorder?.audioBuffers?.collect { buffer ->\r\n                val samples = FloatArray(buffer.sampleCount)\r\n                buffer.fillFloatSamples(samples)\r\n\r\n                // Detect pitch\r\n                val point = detector?.detect(samples, buffer.sampleRate) ?: return@collect\r\n\r\n                // Update UI\r\n                if (point.pitch > 0) {\r\n                    val note = pitchToNote(point.pitch)\r\n                    updatePitchDisplay(note, point.pitch, point.confidence)\r\n                } else {\r\n                    updatePitchDisplay("--", 0f, 0f)\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private fun updatePitchDisplay(note: String, frequency: Float, confidence: Float) {\r\n        runOnUiThread {\r\n            // Update your UI here\r\n            // textViewNote.text = note\r\n            // textViewFrequency.text = "${frequency.toInt()} Hz"\r\n            println("Note: $note, Frequency: ${frequency.toInt()} Hz, Confidence: ${(confidence * 100).toInt()}%")\r\n        }\r\n    }\r\n\r\n    private fun pitchToNote(frequency: Float): String {\r\n        val noteNames = arrayOf("C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B")\r\n        val a4 = 440.0\r\n        val semitones = 12 * kotlin.math.log2(frequency / a4) + 69\r\n        val noteIndex = (semitones.toInt() % 12 + 12) % 12\r\n        val octave = (semitones.toInt() / 12) - 1\r\n        return "${noteNames[noteIndex]}$octave"\r\n    }\r\n\r\n    override fun onDestroy() {\r\n        super.onDestroy()\r\n        scope.cancel()\r\n        detector?.close()\r\n        recorder?.release()\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"what-youll-see",children:"What You'll See"}),"\n",(0,i.jsx)(n.p,{children:"When you sing into the microphone, Logcat will show:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"Note: A4, Frequency: 440 Hz, Confidence: 92%\r\nNote: A4, Frequency: 441 Hz, Confidence: 89%\r\nNote: B4, Frequency: 494 Hz, Confidence: 87%\r\nNote: --, Frequency: 0 Hz, Confidence: 0%   \u2190 breath/silence\r\nNote: C5, Frequency: 523 Hz, Confidence: 91%\n"})}),"\n",(0,i.jsx)(n.p,{children:"The app is:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Recording audio buffers from the microphone (~50ms chunks)"}),"\n",(0,i.jsx)(n.li,{children:"Running pitch detection on each buffer"}),"\n",(0,i.jsx)(n.li,{children:"Converting frequency to musical note name"}),"\n",(0,i.jsx)(n.li,{children:"Showing confidence (how certain the detection is)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Troubleshooting:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Seeing lots of ",(0,i.jsx)(n.code,{children:"--"})," entries? Make sure microphone permission is granted"]}),"\n",(0,i.jsx)(n.li,{children:"Low confidence values? Sing closer to the device, reduce background noise"}),"\n",(0,i.jsxs)(n.li,{children:["No output at all? Check that ",(0,i.jsx)(n.code,{children:"recorder?.start()"})," is being called"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"step-3-add-ui-optional",children:"Step 3: Add UI (Optional)"}),"\n",(0,i.jsxs)(n.p,{children:["Create a simple layout in ",(0,i.jsx)(n.code,{children:"activity_main.xml"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="utf-8"?>\r\n<LinearLayout\r\n    xmlns:android="http://schemas.android.com/apk/res/android"\r\n    android:layout_width="match_parent"\r\n    android:layout_height="match_parent"\r\n    android:orientation="vertical"\r\n    android:gravity="center"\r\n    android:padding="16dp">\r\n\r\n    <TextView\r\n        android:id="@+id/textViewNote"\r\n        android:layout_width="wrap_content"\r\n        android:layout_height="wrap_content"\r\n        android:text="--"\r\n        android:textSize="72sp"\r\n        android:textStyle="bold" />\r\n\r\n    <TextView\r\n        android:id="@+id/textViewFrequency"\r\n        android:layout_width="wrap_content"\r\n        android:layout_height="wrap_content"\r\n        android:text="0 Hz"\r\n        android:textSize="24sp"\r\n        android:layout_marginTop="8dp" />\r\n\r\n    <ProgressBar\r\n        android:id="@+id/progressConfidence"\r\n        style="@style/Widget.AppCompat.ProgressBar.Horizontal"\r\n        android:layout_width="200dp"\r\n        android:layout_height="wrap_content"\r\n        android:max="100"\r\n        android:progress="0"\r\n        android:layout_marginTop="16dp" />\r\n\r\n</LinearLayout>\n'})}),"\n",(0,i.jsx)(n.h2,{id:"complete-example-with-compose",children:"Complete Example with Compose"}),"\n",(0,i.jsx)(n.p,{children:"If you're using Jetpack Compose:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",children:'@Composable\r\nfun PitchDetectorScreen() {\r\n    var note by remember { mutableStateOf("--") }\r\n    var frequency by remember { mutableStateOf(0f) }\r\n    var confidence by remember { mutableStateOf(0f) }\r\n\r\n    val context = LocalContext.current\r\n    val scope = rememberCoroutineScope()\r\n\r\n    DisposableEffect(Unit) {\r\n        var recorder: SonixRecorder? = null\r\n        var detector: CalibraPitch.Detector? = null\r\n\r\n        scope.launch {\r\n            recorder = SonixRecorder.createTemporary(SonixRecorderConfig.VOICE)\r\n            detector = CalibraPitch.createDetector()\r\n            recorder?.start()\r\n\r\n            recorder?.audioBuffers?.collect { buffer ->\r\n                val samples = FloatArray(buffer.sampleCount)\r\n                buffer.fillFloatSamples(samples)\r\n                val point = detector?.detect(samples, buffer.sampleRate) ?: return@collect\r\n\r\n                if (point.pitch > 0) {\r\n                    note = pitchToNote(point.pitch)\r\n                    frequency = point.pitch\r\n                    confidence = point.confidence\r\n                } else {\r\n                    note = "--"\r\n                    frequency = 0f\r\n                    confidence = 0f\r\n                }\r\n            }\r\n        }\r\n\r\n        onDispose {\r\n            detector?.close()\r\n            recorder?.release()\r\n        }\r\n    }\r\n\r\n    Column(\r\n        modifier = Modifier.fillMaxSize(),\r\n        horizontalAlignment = Alignment.CenterHorizontally,\r\n        verticalArrangement = Arrangement.Center\r\n    ) {\r\n        Text(text = note, fontSize = 72.sp, fontWeight = FontWeight.Bold)\r\n        Text(text = "${frequency.toInt()} Hz", fontSize = 24.sp)\r\n        LinearProgressIndicator(\r\n            progress = confidence,\r\n            modifier = Modifier.width(200.dp).padding(top = 16.dp)\r\n        )\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"../guides/detecting-pitch",children:"Detecting Pitch Guide"})," - Deep dive into pitch detection options"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"../guides/recording-audio",children:"Recording Audio Guide"})," - Learn about recording features"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"../guides/live-evaluation",children:"Live Evaluation Guide"})," - Score singing against reference"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453(e,n,r){r.d(n,{R:()=>a,x:()=>s});var t=r(6540);const i={},o=t.createContext(i);function a(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);